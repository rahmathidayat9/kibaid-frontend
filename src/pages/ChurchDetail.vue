<template>
    <div id="churchDetail">
        <ChurchBannerComp :church="local" />
        <FeedPerCategoryComp :feeds="news" class="pb-8" />
        <FaithSectionComp />
        <SOKlasisComp :klasis="local" :items="items" />
        <SOChurchComp :locals="local" />
        <DonationSectionComp />
    </div>
</template>
<script>
import ChurchBannerComp from "@/components/Church/ChurchBanner.vue";
import FaithSectionComp from "@/components/About/FaithSection.vue";
import FeedPerCategoryComp from "@/components/Feeds/FeedPerCategory.vue";
import SOKlasisComp from "@/components/Church/SOKlasis.vue";
import SOChurchComp from "@/components/Church/SOChurch.vue";
import DonationSectionComp from "@/components/Donation/DonationSection.vue";
import axios from 'axios'

export default {
    name: 'ChurchDetailView',
    components: {
        ChurchBannerComp,
        FaithSectionComp,
        FeedPerCategoryComp,
        SOKlasisComp,
        SOChurchComp,
        DonationSectionComp
    },
    data: () => ({
        local: [
            {
                src: require('@/assets/video/bg-yogya.mp4'),
                poster: require('@/assets/img/img-church1.jpg'),
                title: '',
                klasis: '',
                category: 'Gereja',
                address: '',
                periode: '2017 - 2022',
                gembala: [],
                jemaat: [
                    {
                        icon: 'mdi-account-multiple',
                        name: 'Jumlah KK',
                        amount: '83'
                    },
                    {
                        icon: 'mdi-book-open-page-variant',
                        name: 'Persekutuan Sekolah Minggu',
                        amount: '5'
                    },
                    {
                        icon: 'mdi-human-handsup',
                        name: 'Persekutuan Kaum Muda',
                        amount: '12'
                    },
                    {
                        icon: 'mdi-human-female',
                        name: 'Persekutuan Kaum Wanita',
                        amount: '23'
                    },
                    {
                        icon: 'mdi-human-male',
                        name: 'Persekutuan Kaum Pria',
                        amount: '14'
                    },
                    {
                        icon: 'mdi-account-multiple-plus',
                        name: 'Jumlah Jiwa',
                        amount: '123'
                    }
                ]
            }
        ],
        news: [
            {
                src: require('@/assets/img/img-pray1.jpg'),
                title: 'Lorem Ipsum is simply dummy text of the printing and typesetting industry. 1',
                link: 'news/detail',
                description: 'This is the short description for the card purpose.',
                category: 'Klasis',
                date: '22 Agustus 2022'
            },
            {
                src: require('@/assets/img/img-worship1.jpg'),
                title: 'Lorem Ipsum is simply dummy text of the printing and typesetting industry. 2',
                link: 'news/detail',
                description: 'This is the short description for the card purpose.',
                category: 'Klasis',
                date: '22 Agustus 2022'
            },
            {
                src: require('@/assets/img/img-worship2.jpg'),
                title: 'Lorem Ipsum is simply dummy text of the printing and typesetting industry. 3',
                link: 'news/detail',
                description: 'This is the short description for the card purpose.',
                category: 'Klasis',
                date: '22 Agustus 2022'
            },
            {
                src: require('@/assets/img/img-pray1.jpg'),
                title: 'Lorem Ipsum is simply dummy text of the printing and typesetting industry. 4',
                link: 'news/detail',
                description: 'This is the short description for the card purpose.',
                category: 'Klasis',
                date: '22 Agustus 2022'
            },
            {
                src: require('@/assets/img/img-pray1.jpg'),
                title: 'Lorem Ipsum is simply dummy text of the printing and typesetting industry. 1',
                link: 'news/detail',
                description: 'This is the short description for the card purpose.',
                category: 'Klasis',
                date: '22 Agustus 2022'
            },
            {
                src: require('@/assets/img/img-worship1.jpg'),
                title: 'Lorem Ipsum is simply dummy text of the printing and typesetting industry. 2',
                link: 'news/detail',
                description: 'This is the short description for the card purpose.',
                category: 'Klasis',
                date: '22 Agustus 2022'
            },
            {
                src: require('@/assets/img/img-worship2.jpg'),
                title: 'Lorem Ipsum is simply dummy text of the printing and typesetting industry. 3',
                link: 'news/detail',
                description: 'This is the short description for the card purpose.',
                category: 'Klasis',
                date: '22 Agustus 2022'
            },
            {
                src: require('@/assets/img/img-pray1.jpg'),
                title: 'Lorem Ipsum is simply dummy text of the printing and typesetting industry. 4',
                link: 'news/detail',
                description: 'This is the short description for the card purpose.',
                category: 'Klasis',
                date: '22 Agustus 2022'
            },
        ],
        items: [
            // {
            //     tab: 'Ketua',
            //     person: [
            //         {
            //             id: '1',
            //             name: 'Your name here',
            //             src: require('@/assets/img/img-usermale.jpg')
            //         }
            //     ]
            // },
            // {
            //     tab: 'Wakil Ketua',
            //     person: [
            //         {
            //             id: '2',
            //             name: 'Your name here',
            //             src: require('@/assets/img/img-usermale.jpg')
            //         }
            //     ]
            // },
            // {
            //     tab: 'Sekretaris',
            //     person: [
            //         {
            //             id: '3',
            //             name: 'Your name here',
            //             src: require('@/assets/img/img-usermale.jpg')
            //         }
            //     ]
            // },
            // {
            //     tab: 'Wakil Sekretaris',
            //     person: [
            //         {
            //             id: '4',
            //             name: 'Your name here',
            //             src: require('@/assets/img/img-usermale.jpg')
            //         }
            //     ]
            // },
            // {
            //     tab: 'Bendahara',
            //     person: [
            //         {
            //             id: '5',
            //             name: 'Your name here',
            //             src: require('@/assets/img/img-usermale.jpg')
            //         }
            //     ]
            // }, {
            //     tab: 'Bidang PSM',
            //     person: [
            //         {
            //             id: '6',
            //             name: 'Your name here',
            //             src: require('@/assets/img/img-usermale.jpg')
            //         }
            //     ]
            // },
            // {
            //     tab: 'Bidang PKM',
            //     person: [
            //         {
            //             id: '7',
            //             name: 'Your name here',
            //             src: require('@/assets/img/img-usermale.jpg')
            //         },
            //         {
            //             id: '7a',
            //             name: 'Your name here',
            //             src: require('@/assets/img/img-usermale.jpg')
            //         },
            //         {
            //             id: '7b',
            //             name: 'Your name here',
            //             src: require('@/assets/img/img-usermale.jpg')
            //         },
            //         {
            //             id: '7c',
            //             name: 'Your name here',
            //             src: require('@/assets/img/img-usermale.jpg')
            //         },
            //         {
            //             id: '7d',
            //             name: 'Your name here',
            //             src: require('@/assets/img/img-usermale.jpg')
            //         }
            //     ]
            // },
            // {
            //     tab: 'Bidang PKW',
            //     person: [
            //         {
            //             id: '8',
            //             name: 'Your name here',
            //             src: require('@/assets/img/img-usermale.jpg')
            //         }
            //     ]
            // },
            // {
            //     tab: 'Bidang PKP',
            //     person: [
            //         {
            //             id: '9',
            //             name: 'Your name here',
            //             src: require('@/assets/img/img-usermale.jpg')
            //         }
            //     ]
            // },
            // {
            //     tab: 'Bidang Penginjilan',
            //     person: [
            //         {
            //             id: '10',
            //             name: 'Your name here',
            //             src: require('@/assets/img/img-usermale.jpg')
            //         }
            //     ]
            // },
            // {
            //     tab: 'Bidang Pelayanan Sosial',
            //     person: [
            //         {
            //             id: '11',
            //             name: 'Your name here',
            //             src: require('@/assets/img/img-usermale.jpg')
            //         }
            //     ]
            // },
            // {
            //     tab: 'Bidang Multimedia',
            //     person: [
            //         {
            //             id: '12',
            //             name: 'Your name here',
            //             src: require('@/assets/img/img-usermale.jpg')
            //         }
            //     ]
            // }
        ]
    }),
    mounted() {
        this.getChurchDetail()
    },
    methods: {
        async getChurchDetail() {
            let id = this.$route.params.id
            // this.local[0].title = 'SSWAFFEN'
            try {
                const response = await axios.get('http://localhost:8000/api/church/'+id);
                const organisasi = await axios.get('http://localhost:8000/api/organization-tree/'+id);
                const result = response.data.data
                const result_organisasi = organisasi.data.data.primary
                const result_gembala = organisasi.data.data.secondary
                let item = []
                let gembal = Object.entries(result_gembala).map(([key, value]) => {
                    return {
                        src: value.image,
                        name: value.name,
                        jabatan: value.position
                    };
                });
                
                
                for (const key in result_organisasi) {
                    let persons = []
                    let person = result_organisasi[key]

                    for(let i = 0; i < result_organisasi[key].length; i++) {
                        persons.push({
                            id: person[i].id,
                            name: person[i].name,
                            src: require('@/assets/img/img-usermale.jpg')
                        })
                    }
                    
                    item.push({
                       tab: key,
                       person: persons, 
                    })
                }

                this.items = item   
                this.local[0].title = result.name
                this.local[0].klasis = result.klasis
                this.local[0].gembala = gembal

                // detail
                this.bannerTitle = result.title
                this.detail = [
                {
                    src: result.image,
                    imgauthor: 'https://pixabay.com',
                    title: result.title,
                    description: result.body,
                    category: result.news_category,
                    date: '22 Agustus 2022',
                    editor: result.author,
                    url: 'https://kibaid.org/news/detail'
                },
                ]

                this.menu = [
                {
                    label: 'Home',
                    link: '/home'
                },
                {
                    label: result.news_category,
                    link: '/news'
                },
                {
                    label: result.title,
                    link: '/news/detail/'+id
                }
                ]
            } catch (error) {
                // Menghandle kesalahan jika terjadi
                console.error(error);
            }
        }
    }   
}
</script>